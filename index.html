<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Intranet • 실적 관리 콘솔</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    html { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple SD Gothic Neo", "Noto Sans KR", "Malgun Gothic", "맑은 고딕", sans-serif; }
    .spin { animation: spin 1s cubic-bezier(.25,.8,.25,1) 1; }
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
  </style>
</head>
<body class="min-h-screen bg-slate-100">
  <!-- 헤더 -->
  <header class="sticky top-0 z-10 bg-white/80 backdrop-blur border-b border-slate-200">
    <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <div class="w-9 h-9 rounded-2xl bg-slate-900 text-white grid place-items-center text-sm font-semibold">HR</div>
        <div>
          <h1 class="text-xl font-semibold text-slate-900">사내 인트라넷 • 실적 관리 콘솔</h1>
          <p class="text-xs text-slate-500">Confidential — 내부 배포 전용</p>
        </div>
      </div>
      <div class="text-right">
        <div id="headerUser" class="text-sm text-slate-600">미로그인</div>
        <button id="logoutBtn" class="hidden mt-1 text-xs text-slate-500 underline">로그아웃</button>
      </div>
    </div>
  </header>

  <!-- 로그인 카드 -->
  <main class="max-w-6xl mx-auto px-4 py-8">
    <section id="loginSection" class="grid place-items-center">
      <div class="w-full max-w-md bg-white rounded-2xl shadow p-6 border border-slate-200">
        <h2 class="text-lg font-semibold text-slate-900">사원 인증</h2>
        <p class="text-sm text-slate-500 mt-1">사원번호는 닉네임 대체로 사용 가능합니다.</p>
        <div class="mt-4 space-y-3">
          <label class="block">
            <span class="text-sm text-slate-600">사원명</span>
            <input id="nameInput" class="mt-1 w-full rounded-xl border-slate-300 focus:ring-2 focus:ring-slate-900/30" placeholder="예: 김사원" />
          </label>
          <label class="block">
            <span class="text-sm text-slate-600">사원번호</span>
            <input id="idInput" class="mt-1 w-full rounded-xl border-slate-300 focus:ring-2 focus:ring-slate-900/30" placeholder="예: E-1024" />
          </label>
          <button id="loginBtn" class="w-full mt-2 py-2 rounded-xl bg-slate-900 text-white font-medium hover:bg-slate-800">접속</button>
        </div>
      </div>
    </section>

    <!-- 대시보드 -->
    <section id="dashboard" class="hidden">
      <div class="grid md:grid-cols-3 gap-5">
        <div class="md:col-span-2 space-y-5">
          <div class="bg-white rounded-2xl shadow p-6 border border-slate-200">
            <div class="flex items-center justify-between">
              <div>
                <h3 class="text-base font-semibold text-slate-900">개인 실적 현황</h3>
                <p class="text-sm text-slate-500">이번 분기 누적 포인트</p>
              </div>
              <div class="text-right">
                <div class="text-3xl font-extrabold text-slate-900" id="points">0</div>
                <div class="text-xs text-slate-500">pt</div>
              </div>
            </div>
          </div>
        </div>
        <aside class="space-y-5">
          <div class="bg-white rounded-2xl shadow p-6 border border-slate-200">
            <h3 class="text-base font-semibold text-slate-900">이번 달 실적 랭킹</h3>
            <ol id="leaderboard" class="mt-3 space-y-2 text-sm"></ol>
          </div>
        </aside>
      </div>
    </section>
  </main>

  <footer class="max-w-6xl mx-auto px-4 pb-10 text-center text-xs text-slate-500">
    © Intranet Simulation for RP — For friends only
  </footer>

<script>
  // ===== Firebase 초기화 =====
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_AUTH_DOMAIN",
    databaseURL: "YOUR_DB_URL",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_STORAGE_BUCKET",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // ===== 상태 =====
  let current = null;

  // ===== UI 요소 =====
  const loginSection = document.getElementById('loginSection');
  const dashboard = document.getElementById('dashboard');
  const headerUser = document.getElementById('headerUser');
  const logoutBtn = document.getElementById('logoutBtn');
  const nameInput = document.getElementById('nameInput');
  const idInput = document.getElementById('idInput');
  const loginBtn = document.getElementById('loginBtn');
  const pointsEl = document.getElementById('points');
  const leaderboardEl = document.getElementById('leaderboard');

  // ===== 로그인 / 초기화 =====
  function ensureUser(){
    if(!current){ loginSection.classList.remove('hidden'); dashboard.classList.add('hidden'); headerUser.textContent='미로그인'; logoutBtn.classList.add('hidden'); return; }
    loginSection.classList.add('hidden'); dashboard.classList.remove('hidden'); headerUser.textContent = current.name + ' · ' + current.id; logoutBtn.classList.remove('hidden');
    renderPoints();
    subscribeLeaderboard();
  }

  loginBtn.addEventListener('click', ()=>{
    const name = nameInput.value.trim();
    const id = idInput.value.trim();
    if(!name||!id){ alert('사원명과 사원번호를 입력하세요'); return; }
    const userRef = db.ref('users/'+id);
    userRef.get().then(snapshot=>{
      if(snapshot.exists()){
        current = snapshot.val();
      } else {
        current = {name,id,points:100};
        userRef.set(current);
      }
      ensureUser();
    });
  });

  logoutBtn.addEventListener('click', ()=>{
    current = null; ensureUser();
  });

  // ===== 포인트 & 랭킹 =====
  function renderPoints(){
    if(!current) return;
    pointsEl.textContent = current.points;
    db.ref('users').get().then(snapshot=>{
      if(snapshot.exists()){
        const all = snapshot.val();
        const arr = Object.values(all);
        arr.sort((a,b)=>b.points-a.points);
        leaderboardEl.innerHTML='';
        arr.slice(0,10).forEach((u,i)=>{
          const li=document.createElement('li');
          li.textContent = `${i+1}. ${u.name} (${u.id}) - ${u.points}pt`;
          leaderboardEl.appendChild(li);
        });
      }
    });
  }

  function subscribeLeaderboard(){
    db.ref('users').on('value', snapshot=>{
      if(!snapshot.exists()) return;
      const all = snapshot.val();
      const arr = Object.values(all);
      arr.sort((a,b)=>b.points-a.points);
      leaderboardEl.innerHTML='';
      arr.slice(0,10).forEach((u,i)=>{
        const li=document.createElement('li');
        li.textContent = `${i+1}. ${u.name} (${u.id}) - ${u.points}pt`;
        leaderboardEl.appendChild(li);
      });
    });
  }

</script>
</body>
</html>
